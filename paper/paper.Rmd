---
title: |
  Automated reading of residual plots with computer vision models
type: ARTICLE TEMPLATE
author:
  - name: Weihao Li
    affil: a
    email: weihao.li@monash.edu
affiliation:
  - num: a
    address: |
      Department of Econometrics and Business Statistics, Monash University, Clayton, VIC, Australia
bibliography: ref.bib
abstract: |
  TBD.
keywords: |
  TBD
header-includes: |
  \usepackage{lscape}
  \usepackage{hyperref}
  \usepackage[utf8]{inputenc}
  \def\tightlist{}
  \usepackage{setspace}
output: rticles::tf_article
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  message = FALSE, 
  warning = FALSE, 
  echo = FALSE,
  fig.width = 8,
  fig.height = 6,
  out.width = "100%",
  fig.align = "center")
```

```{r}
# Visual inference models and p-value calculation
# remotes::install_github("TengMCing/visage)

library(tidyverse)
library(visage)

# To control the simulation in this file
set.seed(10086)
```


# Introduction

Residuals, within regression analysis, represent the differences between fitted values and observed data points, capturing the unexplained elements in the regression model. The practice of plotting residuals, advocated by influential regression literature [@cook1982residuals; @draper1998applied; @belsley1980regression; @montgomery1982introduction], serves as a standard procedure in regression diagnostics. This visual examination is crucial for identifying deviations from the model assumptions like linearity, homoscedasticity, and normality.

Generating a residual plot in most statistical software is often as straightforward as executing a line of code or clicking a button. However, accurately interpreting a residual plot can be challenging. Consider Figure \ref{fig:false-finding} as an example, the residuals display a triangular shape pointing to the left. While this might suggest heteroskedasticity, it's important to avoid over-interpreting the visual pattern. In this case, the fitted model is correctly specified, and the triangular shape is actually a result of the skewed distribution of the predictors, rather than indicating a flaw in the model.

A residual plot can exhibit various visual features, but it's crucial to recognize that some may arise from the characteristics of predictors and the inherent randomness of the error, rather than indicating a violation of model assumptions [@li2023plot]. The concept of visual inference, as proposed by @buja2009statistical, provides an inferential framework to assess whether residual plots indeed contain visual patterns inconsistent with the model assumptions. The fundamental idea involves testing whether the actual residual plot significantly differs visually from null plots, which are created using residuals generated from the null distribution. Typically, this is accomplished through the lineup protocol. In this approach, the real residual plot is embedded within a lineup alongside several null plots. If the real residual plot can be distinguished from the lineup, it provides evidence for rejecting the null hypothesis.

Delivering a residual plot as a lineup is generally considered a good practice. However, as pointed out by @li2023plot, a primary limitation of the lineup protocol is its reliance on human judgments. Unlike conventional statistical tests that can be performed numerically and automatically in statistical software, the lineup protocol requires human evaluation of images. This characteristic makes it less suitable for large-scale applications, given the associated high labour costs and time requirements.

In this paper, we attempt to address this issue by integrating computer vision models into residual plot diagnostics. The paper is structured as follows: ...



```{r false-finding, fig.cap="An example residual vs fitted values plot (red line indicates 0). The vertical spread of the data points varies with the fitted values. This often indicates the existence of heteroskedasticity."}
set.seed(10131)
ori_x <- rand_lognormal()
mod <- heter_model(b = 0, x = closed_form(~-ori_x))
ori_dat <- mod$gen(300)

ori_dat %>%
  VI_MODEL$plot(theme = theme_light(base_size = 12), size = 1, remove_grid_line = TRUE, ) +
  xlab("Fitted values") +
  ylab("Residuals")
```



<!-- # Related works? -->

<!-- # Literature review -->

<!-- ## Visual inference in residual diagnostics -->

<!-- ## Existing approaches to automated plot analysis -->

<!-- ### Computer vision approaches -->

<!-- ### Other approaches -->

# Methodogology

## Generation of simulated training data

## Architecture of the computer vision model

## Training process and hyperparameter tuning

# Results

## Model evaluation

- Metrics for model performance
- Shap values
- Heatmap

## Comparison with human visual inference

### Overview of the human subject experiment

### Comparison

- power comparison
- decisions

## Case study 1: ...

## Case study 2: ...

## Case study 3: datasaurus

# Dicussion

# Conclusion

- Summary of findings
- Contributions to the field
- Future directions for research

# Acknowledgements
